{"mappings":"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","sources":["src/app.js"],"sourcesContent":["\"use strict\";\r\n\r\nclass FlipDown {\r\n  constructor(uts, el = \"flipdown\") {\r\n    if (typeof uts !== \"number\") {\r\n      throw new Error(`FlipDown: Constructor expected unix timestamp, got ${typeof uts} instead.`);\r\n    }\r\n\r\n    this.version = \"0.3.2\";\r\n    this.initialised = false;\r\n    this.now = this._getTime();\r\n    this.epoch = uts;\r\n    this.countdownEnded = false;\r\n    this.hasEndedCallback = null;\r\n    this.element = document.getElementById(el);\r\n    this.rotors = [];\r\n    this.rotorLeafFront = [];\r\n    this.rotorLeafRear = [];\r\n    this.rotorTops = [];\r\n    this.rotorBottoms = [];\r\n    this.countdown = null;\r\n    this.daysRemaining = 0;\r\n    this.clockValues = {};\r\n    this.clockStrings = {};\r\n    this.clockValuesAsString = [];\r\n    this.prevClockValuesAsString = [];\r\n    this.opts = {\r\n      theme: \"dark\",\r\n      headings: [\"Days\", \"Hours\", \"Minutes\", \"Seconds\"]\r\n    };\r\n\r\n    this._setOptions();\r\n\r\n    console.log(`FlipDown ${this.version} (Theme: ${this.opts.theme})`);\r\n  }\r\n\r\n  start() {\r\n    if (!this.initialised) this._init();\r\n    this.countdown = setInterval(this._tick.bind(this), 1000);\r\n    return this;\r\n  }\r\n\r\n  ifEnded(cb) {\r\n    this.hasEndedCallback = () => {\r\n      cb();\r\n      this.hasEndedCallback = null;\r\n    };\r\n\r\n    return this;\r\n  }\r\n\r\n  _getTime() {\r\n    return new Date().getTime() / 1000;\r\n  }\r\n\r\n  _hasCountdownEnded() {\r\n    if (this.epoch - this.now < 0) {\r\n      this.countdownEnded = true;\r\n\r\n      if (this.hasEndedCallback != null) {\r\n        this.hasEndedCallback();\r\n        this.hasEndedCallback = null;\r\n      }\r\n\r\n      return true;\r\n    } else {\r\n      this.countdownEnded = false;\r\n      return false;\r\n    }\r\n  }\r\n\r\n  _setOptions() {\r\n    this.element.classList.add(`flipdown__theme-${this.opts.theme}`);\r\n  }\r\n\r\n  _init() {\r\n    this.initialised = true;\r\n\r\n    if (this._hasCountdownEnded()) {\r\n      this.daysremaining = 0;\r\n    } else {\r\n      this.daysremaining = Math.floor((this.epoch - this.now) / 86400).toString().length;\r\n    }\r\n\r\n    var dayRotorCount = this.daysremaining <= 2 ? 2 : this.daysremaining;\r\n\r\n    for (var i = 0; i < dayRotorCount + 6; i++) {\r\n      this.rotors.push(this._createRotor(0));\r\n    }\r\n\r\n    var dayRotors = [];\r\n\r\n    for (var i = 0; i < dayRotorCount; i++) {\r\n      dayRotors.push(this.rotors[i]);\r\n    }\r\n\r\n    this.element.appendChild(this._createRotorGroup(dayRotors, 0));\r\n    var count = dayRotorCount;\r\n\r\n    for (var i = 0; i < 3; i++) {\r\n      var otherRotors = [];\r\n\r\n      for (var j = 0; j < 2; j++) {\r\n        otherRotors.push(this.rotors[count]);\r\n        count++;\r\n      }\r\n\r\n      this.element.appendChild(this._createRotorGroup(otherRotors, i + 1));\r\n    }\r\n\r\n    this.rotorLeafFront = Array.prototype.slice.call(this.element.getElementsByClassName(\"rotor-leaf-front\"));\r\n    this.rotorLeafRear = Array.prototype.slice.call(this.element.getElementsByClassName(\"rotor-leaf-rear\"));\r\n    this.rotorTop = Array.prototype.slice.call(this.element.getElementsByClassName(\"rotor-top\"));\r\n    this.rotorBottom = Array.prototype.slice.call(this.element.getElementsByClassName(\"rotor-bottom\"));\r\n\r\n    this._tick();\r\n\r\n    this._updateClockValues(true);\r\n\r\n    return this;\r\n  }\r\n\r\n  _createRotorGroup(rotors, rotorIndex) {\r\n    var rotorGroup = document.createElement(\"div\");\r\n    rotorGroup.className = \"rotor-group\";\r\n    var dayRotorGroupHeading = document.createElement(\"div\");\r\n    dayRotorGroupHeading.className = \"rotor-group-heading\";\r\n    dayRotorGroupHeading.setAttribute(\"data-before\", this.opts.headings[rotorIndex]);\r\n    rotorGroup.appendChild(dayRotorGroupHeading);\r\n    appendChildren(rotorGroup, rotors);\r\n    return rotorGroup;\r\n  }\r\n\r\n  _createRotor(v = 0) {\r\n    var rotor = document.createElement(\"div\");\r\n    var rotorLeaf = document.createElement(\"div\");\r\n    var rotorLeafRear = document.createElement(\"figure\");\r\n    var rotorLeafFront = document.createElement(\"figure\");\r\n    var rotorTop = document.createElement(\"div\");\r\n    var rotorBottom = document.createElement(\"div\");\r\n    rotor.className = \"rotor\";\r\n    rotorLeaf.className = \"rotor-leaf\";\r\n    rotorLeafRear.className = \"rotor-leaf-rear\";\r\n    rotorLeafFront.className = \"rotor-leaf-front\";\r\n    rotorTop.className = \"rotor-top\";\r\n    rotorBottom.className = \"rotor-bottom\";\r\n    rotorLeafRear.textContent = v;\r\n    rotorTop.textContent = v;\r\n    rotorBottom.textContent = v;\r\n    appendChildren(rotor, [rotorLeaf, rotorTop, rotorBottom]);\r\n    appendChildren(rotorLeaf, [rotorLeafRear, rotorLeafFront]);\r\n    return rotor;\r\n  }\r\n\r\n  _tick() {\r\n    this.now = this._getTime();\r\n    var diff = this.epoch - this.now <= 0 ? 0 : this.epoch - this.now;\r\n    this.clockValues.d = Math.floor(diff / 86400);\r\n    diff -= this.clockValues.d * 86400;\r\n    this.clockValues.h = Math.floor(diff / 3600);\r\n    diff -= this.clockValues.h * 3600;\r\n    this.clockValues.m = Math.floor(diff / 60);\r\n    diff -= this.clockValues.m * 60;\r\n    this.clockValues.s = Math.floor(diff);\r\n\r\n    this._updateClockValues();\r\n\r\n    this._hasCountdownEnded();\r\n  }\r\n\r\n  _updateClockValues(init = false) {\r\n    this.clockStrings.d = pad(this.clockValues.d, 2);\r\n    this.clockStrings.h = pad(this.clockValues.h, 2);\r\n    this.clockStrings.m = pad(this.clockValues.m, 2);\r\n    this.clockStrings.s = pad(this.clockValues.s, 2);\r\n    this.clockValuesAsString = (this.clockStrings.d + this.clockStrings.h + this.clockStrings.m + this.clockStrings.s).split(\"\");\r\n    this.rotorLeafFront.forEach((el, i) => {\r\n      el.textContent = this.prevClockValuesAsString[i];\r\n    });\r\n    this.rotorBottom.forEach((el, i) => {\r\n      el.textContent = this.prevClockValuesAsString[i];\r\n    });\r\n\r\n    function rotorTopFlip() {\r\n      this.rotorTop.forEach((el, i) => {\r\n        if (el.textContent != this.clockValuesAsString[i]) {\r\n          el.textContent = this.clockValuesAsString[i];\r\n        }\r\n      });\r\n    }\r\n\r\n    function rotorLeafRearFlip() {\r\n      this.rotorLeafRear.forEach((el, i) => {\r\n        if (el.textContent != this.clockValuesAsString[i]) {\r\n          el.textContent = this.clockValuesAsString[i];\r\n          el.parentElement.classList.add(\"flipped\");\r\n          var flip = setInterval(() => {\r\n            el.parentElement.classList.remove(\"flipped\");\r\n            clearInterval(flip);\r\n          }, 500);\r\n        }\r\n      });\r\n    }\r\n\r\n    if (!init) {\r\n      setTimeout(rotorTopFlip.bind(this), 500);\r\n      setTimeout(rotorLeafRearFlip.bind(this), 500);\r\n    } else {\r\n      rotorTopFlip.call(this);\r\n      rotorLeafRearFlip.call(this);\r\n    }\r\n\r\n    this.prevClockValuesAsString = this.clockValuesAsString;\r\n  }\r\n}\r\n\r\nfunction pad(n, len) {\r\n  n = n.toString();\r\n  return n.length < len ? pad(\"0\" + n, len) : n;\r\n}\r\n\r\nfunction appendChildren(parent, children) {\r\n  children.forEach((el) => {\r\n    parent.appendChild(el);\r\n  });\r\n}\r\n"],"names":[],"version":3,"file":"index.816e7b21.js.map","sourceRoot":"/__parcel_source_root/"}